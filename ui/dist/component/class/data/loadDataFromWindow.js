var o=(e="",r={})=>{throw new Error(`[joystick${e?`.${e}`:""}] ${r.message||r.reason||r}`)};var y=()=>typeof window=="undefined";var c=(e="",r=[])=>{try{console.error(`${e} failed with the following errors:`),r.forEach(t=>{console.log(t.message),t.stack&&console.log(t.stack)})}catch(t){o(e,t)}};var p=(e="{}")=>{try{return JSON.parse(e)}catch{return e}};var _=async(e={})=>{try{let r=await e.text();return p(r)}catch(r){o("api.get.handleParseResponse",r)}},m=(e="",r={})=>{try{return typeof window.fetch!="undefined"&&!r?.skip?new Promise((t,i)=>{let s=r.input?JSON.stringify(r.input):null,d=r.output?JSON.stringify(r.output):null,f=`${window.location.origin}/api/_getters/${e}?input=${s}&output=${d}`,n=document.querySelector('[name="csrf"]')?.getAttribute("content");return fetch(f,{method:"GET",mode:"cors",headers:{...r?.headers||{},"x-joystick-csrf":n},credentials:"include"}).then(async a=>{let u=await _(a);return u?.errors?(c("get request",u.errors),i(u)):t(u)}).catch(a=>(c("get request",[a]),i({errors:[a]})))}):Promise.resolve()}catch(t){o("get request",t)}};var g=async(e={})=>{try{let r=await e.text();return p(r)}catch(r){o("api.set.handleParseResponse",r)}},E=(e={})=>{try{return JSON.stringify(e)}catch(r){o("api.set.getBody",r)}},w=(e="",r={})=>{try{return typeof window.fetch!="undefined"?new Promise((t,i)=>{let s=`${window.location.origin}/api/_setters/${e}`,d=E(r),f=document.querySelector('[name="csrf"]')?.getAttribute("content");return fetch(s,{method:"POST",mode:"cors",headers:{...r?.headers||{},"Content-Type":"application/json","x-joystick-csrf":f},body:d,credentials:"include"}).then(async n=>{let a=await g(n);return a?.errors?(c("set request",a.errors),i(a)):t(a)}).catch(n=>(c("set request",[n]),i({errors:[n]})))}):Promise.resolve()}catch(t){o("set request",t)}};var l={get:m,set:w};var h=e=>{try{return typeof e=="function"}catch(r){o("types.isFunction",r)}};var x=async(e={},r={},t={},i={})=>{try{if(i?.options?.data&&h(i.options.data)){let s=await i.options.data(e,r,t,i);return Promise.resolve(s)}return Promise.resolve()}catch(s){o("component.data.fetch",s)}};var k=(e={},r={},t={})=>{try{return{...e,refetch:async(i={})=>{let s=await x(l,r,i,t);return t.data=k(s,r,t),window.__joystick_data__[t?.id]&&(window.__joystick_data__[t?.id]=s),t?.isTest||t.render({afterRefetchDataRender:()=>{t?.lifecycle?.onRefetchData&&t?.lifecycle?.onRefetchData(t)}}),t.data}}}catch(i){o("component.data.compile",i)}},F=k;var or=(e={})=>{try{if(!y()){let r=window.__joystick_data__&&window.__joystick_data__[e?.id]||{},t=window.__joystick_req__||{};return F(r,t,e)}return e?.data||{}}catch(r){o("component.loadDataFromWindow",r)}};export{or as default};
