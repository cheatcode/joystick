var o=(t="",r={})=>{throw new Error(`[joystick${t?`.${t}`:""}] ${r.message||r.reason||r}`)};var f=()=>typeof window=="undefined";var c=(t="",r=[])=>{try{console.error(`${t} failed with the following errors:`),r.forEach(e=>{console.log(e.message),e.stack&&console.log(e.stack)})}catch(e){o(t,e)}};var u=(t="{}")=>{try{return JSON.parse(t)}catch(r){o("parseJSON",r)}};var k=async(t={})=>{try{let r=await t.text();return u(r)}catch(r){o("api.get.handleParseResponse",r)}},w=(t="",r={})=>{try{if(typeof window.fetch!="undefined"&&!r?.skip)return new Promise((e,i)=>{let s=r.input?JSON.stringify(r.input):null,d=r.output?JSON.stringify(r.output):null,n=`${window.location.origin}/api/_getters/${t}?input=${s}&output=${d}`;return fetch(n,{method:"GET",mode:"cors",headers:{...r?.headers||{}},credentials:"include"}).then(async a=>{let p=await k(a);return p?.errors?(c("get request",p.errors),i(p)):e(p)}).catch(a=>(c("get request",[a]),i({errors:[a]})))})}catch(e){o("get request",e)}};var _=async(t={})=>{try{let r=await t.text();return u(r)}catch(r){o("api.set.handleParseResponse",r)}},E=(t={})=>{try{return JSON.stringify(t)}catch(r){o("api.set.getBody",r)}},m=(t="",r={})=>{try{if(typeof window.fetch!="undefined")return new Promise((e,i)=>{let s=`${window.location.origin}/api/_setters/${t}`,d=E(r);return fetch(s,{method:"POST",mode:"cors",headers:{...r?.headers||{},"Content-Type":"application/json"},body:d,credentials:"include"}).then(async n=>{let a=await _(n);return a?.errors?(c("set request",a.errors),i(a)):e(a)}).catch(n=>(c("set request",[n]),i({errors:[n]})))})}catch(e){o("set request",e)}};var y={get:w,set:m};var h=t=>{try{return typeof t=="function"}catch(r){o("types.isFunction",r)}};var l=async(t={},r={},e={},i={})=>{try{if(i?.options?.data&&h(i.options.data)){let s=await i.options.data(t,r,e,i);return Promise.resolve(s)}return Promise.resolve()}catch(s){o("component.data.fetch",s)}};var x=(t={},r={},e={})=>{try{return{...t,refetch:async(i={})=>{let s=await l(y,r,i,e);return e.data=x(s,r,e),window.__joystick_data__[e?.id]=s,e.render({afterRefetchDataRender:()=>{e?.lifecycle?.onRefetchData&&e?.lifecycle?.onRefetchData(e)}}),s}}}catch(i){o("component.data.compile",i)}},F=x;var or=(t={})=>{try{if(!f()&&window.__joystick_data__&&window.__joystick_data__[t?.id]){let r=window.__joystick_data__[t?.id]||{},e=window.__joystick_req__||{};return F(r,e,t)}return t?.data||{}}catch(r){o("component.loadDataFromWindow",r)}};export{or as default};
