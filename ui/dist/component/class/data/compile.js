var o=(t="",r={})=>{throw new Error(`[joystick${t?`.${t}`:""}] ${r.message||r.reason||r}`)};var a=(t="",r=[])=>{try{console.error(`${t} failed with the following errors:`),r.forEach(e=>{console.log(e.message),e.stack&&console.log(e.stack)})}catch(e){o(t,e)}};var p=(t="{}")=>{try{return JSON.parse(t)}catch{return t}};var g=async(t={})=>{try{let r=await t.text();return p(r)}catch(r){o("api.get.handleParseResponse",r)}},y=(t="",r={})=>{try{return typeof window.fetch!="undefined"&&!r?.skip?new Promise((e,s)=>{let n=r.input?JSON.stringify(r.input):null,d=r.output?JSON.stringify(r.output):null,f=`${window.location.origin}/api/_getters/${t}?input=${n}&output=${d}`,c=document.querySelector('[name="csrf"]')?.getAttribute("content");return fetch(f,{method:"GET",mode:"cors",headers:{...r?.headers||{},"x-joystick-csrf":c},credentials:"include"}).then(async i=>{let u=await g(i);return u?.errors?(a("get request",u.errors),s(u)):e(u)}).catch(i=>(a("get request",[i]),s({errors:[i]})))}):Promise.resolve()}catch(e){o("get request",e)}};var F=async(t={})=>{try{let r=await t.text();return p(r)}catch(r){o("api.set.handleParseResponse",r)}},k=(t={})=>{try{return JSON.stringify(t)}catch(r){o("api.set.getBody",r)}},m=(t="",r={})=>{try{return typeof window.fetch!="undefined"?new Promise((e,s)=>{let n=`${window.location.origin}/api/_setters/${t}`,d=k(r),f=document.querySelector('[name="csrf"]')?.getAttribute("content");return fetch(n,{method:"POST",mode:"cors",headers:{...r?.headers||{},"Content-Type":"application/json","x-joystick-csrf":f},body:d,credentials:"include"}).then(async c=>{let i=await F(c);return i?.errors?(a("set request",i.errors),s(i)):e(i)}).catch(c=>(a("set request",[c]),s({errors:[c]})))}):Promise.resolve()}catch(e){o("set request",e)}};var l={get:y,set:m};var h=t=>{try{return typeof t=="function"}catch(r){o("types.isFunction",r)}};var w=async(t={},r={},e={},s={})=>{try{if(s?.options?.data&&h(s.options.data)){let n=await s.options.data(t,r,e,s);return Promise.resolve(n)}return Promise.resolve()}catch(n){o("component.data.fetch",n)}};var x=(t={},r={},e={})=>{try{return{...t,refetch:async(s={})=>{let n=await w(l,r,s,e);return e.data=x(n,r,e),window.__joystick_data__[e?.id]=n,e.render({afterRefetchDataRender:()=>{e?.lifecycle?.onRefetchData&&e?.lifecycle?.onRefetchData(e)}}),n}}}catch(s){o("component.data.compile",s)}},v=x;export{v as default};
