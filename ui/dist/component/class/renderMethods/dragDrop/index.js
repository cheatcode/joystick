var s=(o="",e={})=>{throw new Error(`[joystick${o?`.${o}`:""}] ${e.message||e.reason||e}`)};var c=o=>{try{return typeof o=="function"}catch(e){s("types.isFunction",e)}};var h=o=>{try{return!!(o&&typeof o=="object"&&!Array.isArray(o))}catch(e){s("types.isObject",e)}};var m=()=>typeof window=="undefined";var l=(o={},e={})=>{Object.entries(o).forEach(([t,r])=>{e[t]=r})};var u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890".split(""),y=(o=16)=>{let e="",t=0;for(;t<o;)e+=u[Math.floor(Math.random()*(u.length-1))],t+=1;return e};var b=(o={},e="",t="id")=>{try{let r=o&&o.id;if(h(o)&&r){let a=Object.keys(o);for(let n=0;n<a.length;n+=1){let i=a[n],d=o[i];if(i===t&&d===e)return o;if(i==="children"&&Array.isArray(d))for(let g=0;g<d.length;g+=1){let T=d[g],f=b(T,e,t);if(f!==null)return f}}}return null}catch(r){s("component.findComponentInTreeByField",r)}},p=b;var A=(o={},e="",t="",r={})=>{try{let a=null;o.dragDrop={...o.dragDrop||{},events:{...o.dragDrop?.events||{},[`drag [data-${e}="${t}"]`]:(n={},i={})=>{r?.events?.onDrag&&c(r.events.onDrag)&&r.events.onDrag(n,i)},[`dragend [data-${e}="${t}"]`]:(n={},i={})=>{e==="droppable"&&r.sortable&&(n.target.classList.remove("is-dragging"),a=null),r?.events?.onDragEnd&&c(r.events.onDragEnd)&&r.events.onDragEnd(n,i)},[`dragenter [data-${e}="${t}"]`]:(n={},i={})=>{r?.events?.onDragEnter&&c(r.events.onDragEnter)&&r.events.onDragEnter(n,i)},[`dragleave [data-${e}="${t}"]`]:(n={},i={})=>{r?.events?.onDragLeave&&c(r.events.onDragLeave)&&r.events.onDragLeave(n,i)},[`dragover [data-${e}="${t}"]`]:(n={},i={})=>{n.preventDefault(),e==="droppable"&&r.sortable&&(a.compareDocumentPosition(n.target)===Node.DOCUMENT_POSITION_PRECEDING?n.target.parentNode.insertBefore(a,n.target):n.target.parentNode.insertBefore(a,n.target.nextSibling)),r?.events?.onDragOver&&c(r.events.onDragOver)&&r.events.onDragOver(n,i)},[`dragstart [data-${e}="${t}"]`]:(n={},i={})=>{if(e==="droppable"&&r.sortable){n.dataTransfer.effectAllowed="move",a=n.target,n.target.classList.add("is-dragging"),n.dataTransfer.setData("text/plain",null);let d=new Image;d.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=",n.dataTransfer.setDragImage(d,1,1)}r?.events?.onDragStart&&c(r.events.onDragStart)&&r.events.onDragStart(n,i)},[`drop [data-${e}="${t}"]`]:(n={},i={})=>{r?.events?.onDrop&&c(r.events.onDrop)&&r.events.onDrop(n,i)}}}}catch(a){s("component.renderMethods.dragDrop.attachEvents",a)}};var D=class{constructor(e={}){l(e,this)}initHTML(e=""){let t=document.createElement("div");t.innerHTML=e?.trim()?.replace(/\n/g,"");let r=t.childNodes;if(r?.length>0){for(let a=0;a<r?.length;a+=1){let n=r[a],i=this.id||y();n.setAttribute("draggable",!0),n.setAttribute("data-draggable",i),this.attachEvents(i,this.parent)}return t.innerHTML}}attachEvents(e="",t={}){let r=p(window.joystick._internal.tree,t.instanceId,"instanceId")?.instance||{};A(r,"draggable",e,{events:this.events})}},E=D;var x=class{constructor(e={}){l(e,this)}initHTML(e=""){let t=document.createElement("div");t.innerHTML=e?.trim()?.replace(/\n/g,"");let r=t.childNodes;if(r?.length>0){for(let a=0;a<r?.length;a+=1)r[a].setAttribute("data-droppable",this.name),this.attachEvents(this.name,this.parent);return t.innerHTML}}attachEvents(e="",t={}){let r=p(window.joystick._internal.tree,t.instanceId,"instanceId")?.instance||{};A(r,"droppable",e,{events:this.events,sortable:this.sortable})}},w=x;var I=function(o="",e={}){try{let t=new E({...e,origin:this.name,parent:this.parent});return m()?o:t.initHTML(o,e?.id)}catch(t){s("component.renderMethods.dragDrop.draggable",t)}},v=function(e="",t=null,r={}){try{let a=new w({name:e,parent:this,...r});if(!t||t&&!c(t))throw Error("Second argument to droppable must be a callback function returning HTML.");return m()?t(I.bind({name:e,parent:this})):a.initHTML(t(I.bind({name:e,parent:this})))}catch(a){s("component.renderMethods.dragDrop",a)}},ne=v;export{ne as default};
