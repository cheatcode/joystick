var c=(e="",t={})=>{throw new Error(`[joystick${e?`.${e}`:""}] ${t.message||t.reason||t}`)};var m=(e={})=>{try{return Object.entries(e).map(([t,o])=>{let[s,...n]=t.split(" ");return{type:s.toLowerCase(),selector:n.join(" "),handler:o}})}catch(t){c("component.events.serialize",t)}};var f="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890".split(""),w=(e=16)=>{let t="",o=0;for(;o<e;)t+=f[Math.floor(Math.random()*(f.length-1))],o+=1;return t};var p=(e="",t=[])=>{typeof window!="undefined"&&!!window.__joystick_test__&&(window.test={...window.test||{},functionCalls:{...window?.test?.functionCalls||{},[e]:[...window?.test?.functionCalls&&window?.test?.functionCalls[e]||[],{calledAt:new Date().toISOString(),args:t}]}})};var u=(e={},t={},o=[])=>{try{let s=Object.keys(e?.events||{})?.length>0?m(e?.events):[];for(let n=0;n<s?.length;n+=1){let r=s[n];o.push({...r,instance:e,elements:document.querySelectorAll(`body [js-i="${e.instanceId}"] ${r?.selector}`),handler:function(i){r.handler(i,{...e||{},setState:e?.setState.bind(e),...t||{}}),p(`ui.${e?.options?.test?.name||w()}.events.${r.type}.selector_${r?.selector}`,[i,{...e||{},setState:e?.setState.bind(e),...t||{}}])}})}if(e?.children){let n=Object.entries(e?.children)?.flatMap(([r,l])=>l);for(let r=0;r<n?.length;r+=1){let l=n[r];u(l,t,o)}}return o}catch(s){c("component.eve!nts.registerListenersFix.getListeners",s)}},h=(e={},t={})=>{try{let s=u(e,t,[])?.flatMap((n={})=>[].flatMap.call(n?.elements||[],r=>{let{elements:l=[],...i}=n||{};return{...i,element:r}}));for(let n=0;n<s?.length;n+=1){let{instance:r,element:l,elementSelector:i,type:a,handler:d}=s[n];l.addEventListener(a,d),r._eventListeners=[...r?._eventListeners||[],{instance:r,element:l,elementSelector:i,type:a,handler:d}]}}catch(o){c("component.events.registerListenersFix",o)}},L=h;export{L as default};
