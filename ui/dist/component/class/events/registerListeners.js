var l=(e="",r={})=>{throw new Error(`[joystick${e?`.${e}`:""}] ${r.message||r.reason||r}`)};var m=(e={})=>{try{return Object.entries(e).map(([r,n])=>{let[o,...s]=r.split(" ");return{type:o.toLowerCase(),selector:s.join(" "),handler:n}})}catch(r){l("component.events.serialize",r)}};var d=(e={},r={})=>{try{let n=[...m(e?.events)?.map((o={})=>({...o,instance:e,elements:document.querySelectorAll(`body [js-i="${e.instanceId}"] ${o?.selector}`),handler:function(t){Object.defineProperty(t,"target",{value:t.composedPath()[0]}),o.handler(t,{...e||{},setState:e?.setState.bind(e),...r||{}})}}))];if(e?.children){let s=(Object.values(e?.children||{})?.reduce((t=[],i=[])=>[...t,...i],[])).flatMap(t=>d(t,r));n=[...n,...s]}return n}catch(n){l("component.events.registerListenersFix.getListeners",n)}},p=(e={},r={})=>{try{let o=d(e,r,[])?.flatMap((s={})=>[].flatMap.call(s?.elements||[],t=>{let{elements:i=[],...c}=s||{};return{...c,element:t}}));for(let s=0;s<o?.length;s+=1){let{instance:t,element:i,type:c,handler:a}=o[s];i.addEventListener(c,a),t._eventListeners=[...t?._eventListeners||[],{instance:t,element:i,type:c,handler:a}]}}catch(n){l("component.events.registerListenersFix",n)}},y=p;export{y as default};
