var c=(e="",t={})=>{throw new Error(`[joystick${e?`.${e}`:""}] ${t.message||t.reason||t}`)};var m=(e={})=>{try{return Object.entries(e).map(([t,n])=>{let[s,...o]=t.split(" ");return{type:s.toLowerCase(),selector:o.join(" "),handler:n}})}catch(t){c("component.events.serialize",t)}};var f="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890".split(""),w=(e=16)=>{let t="",n=0;for(;n<e;)t+=f[Math.floor(Math.random()*(f.length-1))],n+=1;return t};var p=(e="",t=[])=>{typeof window!="undefined"&&!!window.__joystick_test__&&(window.test={...window.test||{},functionCalls:{...window?.test?.functionCalls||{},[e]:[...window?.test?.functionCalls&&window?.test?.functionCalls[e]||[],{calledAt:new Date().toISOString(),args:t}]}})};var u=(e={},t={},n=[])=>{try{let s=Object.keys(e?.events||{})?.length>0?m(e?.events):[];for(let o=0;o<s?.length;o+=1){let r=s[o];n.push({...r,instance:e,elements:document.querySelectorAll(`body [js-i="${e.instanceId}"] ${r?.selector}`),handler:function(i){r.handler(i,{...e||{},setState:e?.setState.bind(e),...t||{}}),p(`ui.${e?.options?.test?.name||w()}.events.${r.type}.selector_${r?.selector}`,[i,{...e||{},setState:e?.setState.bind(e),...t||{}}])}})}if(e?.children){let o=Object.entries(e?.children)?.flatMap(([r,l])=>l);for(let r=0;r<o?.length;r+=1){let l=o[r];u(l,t,n)}}return n}catch(s){c("component.events.registerListeners.getListeners",s)}},h=(e={},t={})=>{try{let s=u(e,t,[])?.flatMap((o={})=>[].flatMap.call(o?.elements||[],r=>{let{elements:l=[],...i}=o||{};return{...i,element:r}}));for(let o=0;o<s?.length;o+=1){let{instance:r,element:l,selector:i,type:a,handler:d}=s[o];l.addEventListener(a,d),r._eventListeners=[...r?._eventListeners||[],{instance:r,element:l,selector:i,type:a,handler:d}]}}catch(n){c("component.events.registerListeners",n)}},_=h;export{_ as default};
