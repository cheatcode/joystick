var o=(e="",t={})=>{throw new Error(`[joystick${e?`.${e}`:""}] ${t.message||t.reason||t}`)};var m=e=>{try{return e instanceof Element}catch(t){o("types.isDOM",t)}};var d=e=>{try{return typeof e=="function"}catch(t){o("types.isFunction",t)}};var y=e=>{try{return!!(e&&typeof e=="object"&&!Array.isArray(e))}catch(t){o("types.isObject",t)}};var f=(e={})=>{try{window.joystick._internal.tree={id:e?.id||null,instanceId:e?.instanceId||null,instance:e,children:[]}}catch(t){o("mount.initializeJoystickComponentTree",t)}};var h=()=>typeof window=="undefined";var F=(e="")=>{try{let[t,i]=e?.split(".");return i?window?.joystick?._internal?.queues[t][i]:window?.joystick?._internal?.queues[t]}catch(t){o("processQueue.getQueue",t)}},u=(e="",t=null)=>{try{h()||(F(e)||{}).process(t)}catch(i){o("processQueue",i)}};var w=(e={},t=null)=>{try{return e.innerHTML="",e.appendChild(t),t}catch(i){o("mount.appendToDOM",i)}};var x=(e={})=>{try{return Object.entries(e).map(([t,i])=>{let[s,...r]=t.split(" ");return{type:s.toLowerCase(),selector:r.join(" "),handler:i}})}catch(t){o("component.events.serialize",t)}};var b=(e={},t={},i=[])=>{try{let s=Object.keys(e?.events||{})?.length>0?x(e?.events):[];for(let r=0;r<s?.length;r+=1){let n=s[r];i.push({...n,instance:e,elements:document.querySelectorAll(`body [js-i="${e.instanceId}"] ${n?.selector}`),handler:function(p){Object.defineProperty(p,"target",{value:p.composedPath()[0]}),n.handler(p,{...e||{},setState:e?.setState.bind(e),...t||{}})}})}if(e?.children){let r=Object.entries(e?.children)?.flatMap(([n,c])=>c);for(let n=0;n<r?.length;n+=1){let c=r[n];b(c,t,i)}}return i}catch(s){o("component.events.registerListenersFix.getListeners",s)}},k=(e={},t={})=>{try{let s=b(e,t,[])?.flatMap((r={})=>[].flatMap.call(r?.elements||[],n=>{let{elements:c=[],...p}=r||{};return{...p,element:n}}));for(let r=0;r<s?.length;r+=1){let{instance:n,element:c,elementSelector:p,type:a,handler:l}=s[r];c.addEventListener(a,l),n._eventListeners=[...n?._eventListeners||[],{instance:n,element:c,elementSelector:p,type:a,handler:l}]}}catch(i){o("component.events.registerListenersFix",i)}},g=k;var G=(e=null,t={},i=null,s=!1)=>{try{d(e)||o("mount","Component to mount must be a function."),y(t)||o("mount","props must be an object."),m(i)||o("mount","target must be a DOM node.");let r=e({props:t});f(r);let n=r.render({mounting:!0,existingChildren:window.__joystick_childrenBeforeHMRUpdate__||null});n&&(n.setAttribute("js-ssrId",r.ssrId),n.setAttribute("js-c",r.id),n.setAttribute("js-i",r.instanceId)),r.lifecycle.onBeforeMount(),u("lifecycle.onBeforeMount"),w(i,n),r.setDOMNodeOnInstance(),r.appendCSSToHead(s),g(r,r.renderMethods),r.lifecycle.onMount(),u("lifecycle.onMount")}catch(r){o("mount",r)}};export{G as default};
