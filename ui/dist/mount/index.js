var n=(e="",t={})=>{throw new Error(`[joystick${e?`.${e}`:""}] ${t.message||t.reason||t}`)};var d=e=>{try{return e instanceof Element}catch(t){n("types.isDOM",t)}};var l=e=>{try{return typeof e=="function"}catch(t){n("types.isFunction",t)}};var y=e=>{try{return!!(e&&typeof e=="object"&&!Array.isArray(e))}catch(t){n("types.isObject",t)}};var f=(e={})=>{try{window.joystick._internal.tree={id:e?.id||null,instanceId:e?.instanceId||null,instance:e,children:[]}}catch(t){n("mount.initializeJoystickComponentTree",t)}};var h=()=>typeof window=="undefined";var b=(e="")=>{try{let[t,o]=e?.split(".");return o?window?.joystick?._internal?.queues[t][o]:window?.joystick?._internal?.queues[t]}catch(t){n("processQueue.getQueue",t)}},p=(e="",t=null)=>{try{h()||(b(e)||{}).process(t)}catch(o){n("processQueue",o)}};var w=(e={},t=null)=>{try{return e.innerHTML="",e.appendChild(t),t}catch(o){n("mount.appendToDOM",o)}};var u=(e={})=>{try{return Object.entries(e).map(([t,o])=>{let[r,...s]=t.split(" ");return{type:r.toLowerCase(),selector:s.join(" "),handler:o}})}catch(t){n("component.events.serialize",t)}};var x=(e={},t={})=>{try{let o=[...u(e?.events)?.map((r={})=>({...r,instance:e,elements:document.querySelectorAll(`body [js-i="${e.instanceId}"] ${r?.selector}`),handler:function(i){Object.defineProperty(i,"target",{value:i.composedPath()[0]}),r.handler(i,{...e||{},setState:e?.setState.bind(e),...t||{}})}}))];if(e?.children){let s=(Object.values(e?.children||{})?.reduce((i=[],c=[])=>[...i,...c],[])).flatMap(i=>x(i,t));o=[...o,...s]}return o}catch(o){n("component.events.registerListenersFix.getListeners",o)}},k=(e={},t={})=>{try{let r=x(e,t,[])?.flatMap((s={})=>[].flatMap.call(s?.elements||[],i=>{let{elements:c=[],...a}=s||{};return{...a,element:i}}));for(let s=0;s<r?.length;s+=1){let{instance:i,element:c,type:a,handler:m}=r[s];c.addEventListener(a,m),i._eventListeners=[...i?._eventListeners||[],{instance:i,element:c,type:a,handler:m}]}}catch(o){n("component.events.registerListenersFix",o)}},g=k;var W=(e=null,t={},o=null)=>{try{l(e)||n("mount","Component to mount must be a function."),y(t)||n("mount","props must be an object."),d(o)||n("mount","target must be a DOM node.");let r=e({props:t});f(r);let s=r.render({mounting:!0});s&&(s.setAttribute("js-ssrId",r.ssrId),s.setAttribute("js-c",r.id),s.setAttribute("js-i",r.instanceId)),r.lifecycle.onBeforeMount(),p("lifecycle.onBeforeMount"),w(o,s),r.setDOMNodeOnInstance(),r.appendCSSToHead(),g(r,r.renderMethods),r.lifecycle.onMount(),p("lifecycle.onMount")}catch(r){n("mount",r)}};export{W as default};
