var n=(e="",t={})=>{throw new Error(`[joystick${e?`.${e}`:""}] ${t.message||t.reason||t}`)};var m=e=>{try{return!0}catch(t){n("types.isDOM",t)}};var d=e=>{try{return typeof e=="function"}catch(t){n("types.isFunction",t)}};var f=e=>{try{return!!(e&&typeof e=="object"&&!Array.isArray(e))}catch(t){n("types.isObject",t)}};var y=(e={})=>{try{window.joystick._internal.tree={id:e?.id||null,instanceId:e?.instanceId||null,instance:e,children:[]}}catch(t){n("mount.initializeJoystickComponentTree",t)}};var w=()=>typeof window=="undefined";var I=(e="")=>{try{let[t,o]=e?.split(".");return o?window?.joystick?._internal?.queues[t][o]:window?.joystick?._internal?.queues[t]}catch(t){n("processQueue.getQueue",t)}},p=(e="",t=null)=>{try{w()||(I(e)||{}).process(t)}catch(o){n("processQueue",o)}};var h=(e={},t=null)=>{try{return e.innerHTML="",e.appendChild(t),t}catch(o){n("mount.appendToDOM",o)}};var x=(e={})=>{try{return Object.entries(e).map(([t,o])=>{let[r,...i]=t.split(" ");return{type:r.toLowerCase(),selector:i.join(" "),handler:o}})}catch(t){n("component.events.serialize",t)}};var b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890".split(""),g=(e=16)=>{let t="",o=0;for(;o<e;)t+=b[Math.floor(Math.random()*(b.length-1))],o+=1;return t};var k=(e="",t=[])=>{typeof window!="undefined"&&!!window.__joystick_test__&&(window.test={...window.test||{},functionCalls:{...window?.test?.functionCalls||{},[e]:[...window?.test?.functionCalls&&window?.test?.functionCalls[e]||[],{calledAt:new Date().toISOString(),args:t}]}})};var F=(e={},t={},o=[])=>{try{let r=Object.keys(e?.events||{})?.length>0?x(e?.events):[];for(let i=0;i<r?.length;i+=1){let s=r[i];o.push({...s,instance:e,elements:document.querySelectorAll(`body [js-i="${e.instanceId}"] ${s?.selector}`),handler:function(l){s.handler(l,{...e||{},setState:e?.setState.bind(e),...t||{}}),k(`ui.${e?.options?.test?.name||g()}.events.${s.type}.selector_${s?.selector}`,[l,{...e||{},setState:e?.setState.bind(e),...t||{}}])}})}if(e?.children){let i=Object.entries(e?.children)?.flatMap(([s,c])=>c);for(let s=0;s<i?.length;s+=1){let c=i[s];F(c,t,o)}}return o}catch(r){n("component.eve!nts.registerListenersFix.getListeners",r)}},_=(e={},t={})=>{try{let r=F(e,t,[])?.flatMap((i={})=>[].flatMap.call(i?.elements||[],s=>{let{elements:c=[],...l}=i||{};return{...l,element:s}}));for(let i=0;i<r?.length;i+=1){let{instance:s,element:c,elementSelector:l,type:u,handler:a}=r[i];c.addEventListener(u,a),s._eventListeners=[...s?._eventListeners||[],{instance:s,element:c,elementSelector:l,type:u,handler:a}]}}catch(o){n("component.events.registerListenersFix",o)}},j=_;var Y=(e=null,t={},o=null)=>{try{d(e)||n("mount","Component to mount must be a function."),f(t)||n("mount","props must be an object."),m(o)||n("mount","target must be a DOM node.");let r=e({props:t});y(r);let i=r.render({mounting:!0,existingChildren:window.__joystick_childrenBeforeHMRUpdate__||null});return i&&(i.setAttribute("js-c",r.id),i.setAttribute("js-i",r.instanceId)),r.lifecycle.onBeforeMount(),p("lifecycle.onBeforeMount"),h(o,i),r.setDOMNodeOnInstance(),window.joystick._internal.css.update(),j(r,r.renderMethods),r.lifecycle.onMount(),p("lifecycle.onMount"),r}catch(r){n("mount",r)}};export{Y as default};
