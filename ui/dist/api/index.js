var s=(e="",r={})=>{throw new Error(`[joystick${e?`.${e}`:""}] ${r.message||r.reason||r}`)};var a=(e="",r=[])=>{try{console.error(`${e} failed with the following errors:`),r.forEach(t=>{console.log(t.message),t.stack&&console.log(t.stack)})}catch(t){s(e,t)}};var u=(e="{}")=>{try{return JSON.parse(e)}catch{return e}};var h=async(e={})=>{try{let r=await e.text();return u(r)}catch(r){s("api.get.handleParseResponse",r)}},l=(e="",r={})=>{try{return typeof window.fetch!="undefined"&&!r?.skip?new Promise((t,c)=>{let p=r.input?JSON.stringify(r.input):null,d=r.output?JSON.stringify(r.output):null,m=`${window.location.origin}/api/_getters/${e}?input=${p}&output=${d}`,n=document.querySelector('[name="csrf"]')?.getAttribute("content");return fetch(m,{method:"GET",mode:"cors",headers:{...r?.headers||{},"x-joystick-csrf":n},credentials:"include"}).then(async o=>{let i=await h(o);return i?.errors?(a("get request",i.errors),c(i)):t(i)}).catch(o=>(a("get request",[o]),c({errors:[o]})))}):Promise.resolve()}catch(t){s("get request",t)}};var w=async(e={})=>{try{let r=await e.text();return u(r)}catch(r){s("api.set.handleParseResponse",r)}},y=(e={})=>{try{return JSON.stringify(e)}catch(r){s("api.set.getBody",r)}},f=(e="",r={})=>{try{return typeof window.fetch!="undefined"?new Promise((t,c)=>{let p=`${window.location.origin}/api/_setters/${e}`,d=y(r),m=document.querySelector('[name="csrf"]')?.getAttribute("content");return fetch(p,{method:"POST",mode:"cors",headers:{...r?.headers||{},"Content-Type":"application/json","x-joystick-csrf":m},body:d,credentials:"include"}).then(async n=>{let o=await w(n);return o?.errors?(a("set request",o.errors),c(o)):t(o)}).catch(n=>(a("set request",[n]),c({errors:[n]})))}):Promise.resolve()}catch(t){s("set request",t)}};var T={get:l,set:f};export{T as default};
