var t=(r="",e={})=>{throw new Error(`[joystick${r?`.${r}`:""}] ${e.message||e.reason||e}`)};var n=(r="",e=[])=>{try{console.error(`${r} failed with the following errors:`),e.forEach(o=>{console.log(o.message),o.stack&&console.log(o.stack)})}catch(o){t(r,o)}};var l=(r="{}")=>{try{return JSON.parse(r)}catch{return r}};var u=(r={})=>Object.entries(r).map(([e,o])=>`${e}=${o}`)?.join("; ");var m=async(r={})=>{try{let e=await r.text();return l(e)}catch(e){t("api.get.handleParseResponse",e)}},j=(r="",e={})=>{try{return typeof window.fetch!="undefined"&&!e?.skip?new Promise((o,i)=>{let d=e.input?JSON.stringify(e.input):null,f=e.output?JSON.stringify(e.output):null,w=`${window.location.origin}/api/_getters/${r}?input=${d}&output=${f}`,_=document.querySelector('[name="csrf"]')?.getAttribute("content"),c={...e?.headers||{},"x-joystick-csrf":_};return window?.__joystick_test__&&(c.Cookie=u({joystickLoginToken:window.__joystick_test_login_token__,joystickLoginTokenExpiresAt:window.__joystick_test_login_token_expires_at__})),e?.loader?.instance&&e?.loader?.instance?.setState({[e?.loader?.state||`${r}_loading`]:!0}),fetch(w,{method:"GET",mode:"cors",headers:c,credentials:"include"}).then(async s=>{let a=await m(s);return e?.loader?.instance&&e?.loader?.instance?.setState({[e?.loader?.state||`${r}_loading`]:!1}),a?.errors?(n("get request",a.errors),i(a)):o(a)}).catch(s=>(n("get request",[s]),e?.loader?.instance&&e?.loader?.instance?.setState({[e?.loader?.state||`${r}_loading`]:!1}),i({errors:[s]})))}):Promise.resolve()}catch(o){t("get request",o)}};export{j as default};
