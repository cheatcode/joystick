{
  "version": 3,
  "sources": ["../../src/lib/get_architecture.js"],
  "sourcesContent": ["import os from 'os';\nimport { execSync } from 'child_process';\n\nconst get_architecture = () => {\n  // Debug logging\n  console.log('DEBUG: os.platform():', os.platform());\n  console.log('DEBUG: os.arch():', os.arch());\n  console.log('DEBUG: process.arch:', process.arch);\n  console.log('DEBUG: process.env.ARCHPREFERENCE:', process.env.ARCHPREFERENCE);\n  \n  // Check if running under Rosetta emulation on macOS\n  if (os.platform() === 'darwin') {\n    // Check if explicitly running under x86_64 architecture\n    if (process.env.ARCHPREFERENCE === 'i386' || \n        process.env.ARCHPREFERENCE === 'x86_64' ||\n        process.arch === 'x64') {\n      console.log('DEBUG: Detected x86_64 via environment/process.arch');\n      return 'x86_64';\n    }\n    \n    // Check if process was started with arch command\n    try {\n      const result = execSync('sysctl -n sysctl.proc_translated 2>/dev/null || echo 0', { encoding: 'utf8' }).trim();\n      console.log('DEBUG: sysctl.proc_translated result:', result);\n      if (result === '1') {\n        console.log('DEBUG: Detected x86_64 via Rosetta translation');\n        return 'x86_64';\n      }\n    } catch (error) {\n      console.log('DEBUG: sysctl command failed:', error.message);\n    }\n    \n    // Additional check: try to detect if we're running under arch command\n    try {\n      const uname_result = execSync('uname -m', { encoding: 'utf8' }).trim();\n      console.log('DEBUG: uname -m result:', uname_result);\n      \n      // Check if the system reports x86_64 but Node.js reports arm64 (Rosetta case)\n      if (uname_result === 'x86_64' && os.arch() === 'arm64') {\n        console.log('DEBUG: Detected x86_64 via uname mismatch with os.arch()');\n        return 'x86_64';\n      }\n    } catch (error) {\n      console.log('DEBUG: uname command failed:', error.message);\n    }\n  }\n\n  const arch = os.arch();\n  console.log('DEBUG: Falling back to os.arch():', arch);\n  if (arch === 'arm64') return 'arm64';\n  if (arch === 'x64') return 'x86_64';\n  throw new Error(`Unsupported architecture: ${arch}`);\n};\n\nexport default get_architecture;\n"],
  "mappings": "AAAA,OAAOA,MAAQ,KACf,OAAS,YAAAC,MAAgB,gBAEzB,MAAMC,EAAmB,IAAM,CAQ7B,GANA,QAAQ,IAAI,wBAAyBF,EAAG,SAAS,CAAC,EAClD,QAAQ,IAAI,oBAAqBA,EAAG,KAAK,CAAC,EAC1C,QAAQ,IAAI,uBAAwB,QAAQ,IAAI,EAChD,QAAQ,IAAI,qCAAsC,QAAQ,IAAI,cAAc,EAGxEA,EAAG,SAAS,IAAM,SAAU,CAE9B,GAAI,QAAQ,IAAI,iBAAmB,QAC/B,QAAQ,IAAI,iBAAmB,UAC/B,QAAQ,OAAS,MACnB,eAAQ,IAAI,qDAAqD,EAC1D,SAIT,GAAI,CACF,MAAMG,EAASF,EAAS,yDAA0D,CAAE,SAAU,MAAO,CAAC,EAAE,KAAK,EAE7G,GADA,QAAQ,IAAI,wCAAyCE,CAAM,EACvDA,IAAW,IACb,eAAQ,IAAI,gDAAgD,EACrD,QAEX,OAASC,EAAO,CACd,QAAQ,IAAI,gCAAiCA,EAAM,OAAO,CAC5D,CAGA,GAAI,CACF,MAAMC,EAAeJ,EAAS,WAAY,CAAE,SAAU,MAAO,CAAC,EAAE,KAAK,EAIrE,GAHA,QAAQ,IAAI,0BAA2BI,CAAY,EAG/CA,IAAiB,UAAYL,EAAG,KAAK,IAAM,QAC7C,eAAQ,IAAI,0DAA0D,EAC/D,QAEX,OAASI,EAAO,CACd,QAAQ,IAAI,+BAAgCA,EAAM,OAAO,CAC3D,CACF,CAEA,MAAME,EAAON,EAAG,KAAK,EAErB,GADA,QAAQ,IAAI,oCAAqCM,CAAI,EACjDA,IAAS,QAAS,MAAO,QAC7B,GAAIA,IAAS,MAAO,MAAO,SAC3B,MAAM,IAAI,MAAM,6BAA6BA,CAAI,EAAE,CACrD,EAEA,IAAOC,EAAQL",
  "names": ["os", "execSync", "get_architecture", "result", "error", "uname_result", "arch", "get_architecture_default"]
}
