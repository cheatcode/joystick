import d from"../../lib/build/index.js";import n from"../../lib/cli_log.js";import i from"./get_deployment.js";import p from"./get_push_domain.js";import c from"./get_settings_file.js";import l from"./get_deployment_token.js";import"./upload_build_to_push.js";import m from"../../lib/loader.js";const u=async(r="")=>{const e=await l(r);return e||(n("Must pass a deployment token via the -t or --token flag, or, have an existing deployment token on your machine.",{level:"danger",docs:"https://cheatcode.co/docs/push/authentication"}),process.exit(0))},y=async(r={},e={})=>{if(!e?.domain)return n("Must pass a deployment via -d or --domain flag.",{level:"danger",docs:"https://cheatcode.co/docs/push/cli"}),process.exit(0);process.loader=new m,process.loader.print("Starting deployment...");const a=await u(e?.deployment_token),s=e?.environment||"production",h=await c({environment:s}),o=p(e?.push_server),t=await i({domain:e?.domain,deployment_token:a,push_domain:o});if(console.log(t),!t)return n(`Sorry, we couldn't find a deployment with the domain ${e?.domain} on your account. If you haven't created it yet, head over to the Push dashboard: https://push.cheatcode.co/deployments/create`,{level:"danger",docs:"https://cheatcode.co/docs/push/deployments/create-a-new-deployment"}),process.exit(0);const _=new Date().toISOString();await d({environment:s,encrypt_build:!0,encryption_key:t?.deployment_secret,silence_confirmation:!0}),process.loader.print("Deploying to Push..."),process.loader.print(t?.intial_deployment_completed?`Deploying. Monitor your deployment at ${o}/deployments/${t?._id}.`:`Deploying. Finish your deployment's setup at ${o}/deployments/${t?._id}/setup.`)};var S=y;export{S as default};
//# sourceMappingURL=index.js.map
