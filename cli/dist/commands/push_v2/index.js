import p from"chalk";import"inquirer";import m from"../../lib/build/index.js";import i from"../../lib/cli_log.js";import"./prompts/confirm_deployment.js";import"./create_version.js";import"./get_deployment.js";import d from"./get_push_domain.js";import l from"./get_settings_file.js";import a from"./get_session_token.js";import"./handle_initial_deployment.js";import"./handle_version_deployment.js";import _ from"../../lib/loader.js";import"./upload_build_to_cdn.js";import"./validate_deployment.js";import"./validate_push_config.js";const P=(o="",t="",s={})=>{let e="";for(let n=0;n<s?.errors?.length;n+=1){const r=s?.errors[n];o==="push_config"&&(e+=`${p.yellowBright(`> ${r.field}`)}
`),e+=`${r?.error}
${n+1===s?.errors?.length?"":`
`}`}i(`${t?`${p.yellowBright(t)}


`:""}${e}`,{level:"danger",docs:{push_config:"https://cheatcode.co/docs/push/config",deployment:"https://cheatcode.co/docs/push/subscription"}[o]}),process.exit(0)},u=async()=>{const o=await a();return o||(i(data?.error?.message,{level:"danger",docs:"https://cheatcode.co/docs/push/cli#authentication"}),process.exit(0))},Q=(o="")=>(i(`settings.${o}.json must contain a push config object. Add this following the docs link below and try again.`,{level:"danger",docs:"https://cheatcode.co/docs/push/config"}),process.exit(0)),f=async(o={},t={})=>{process.loader=new _,process.loader.print("Starting deployment...");const s=await u(),e=t?.environment||"production",r=(await l({environment:e}))?.config?.push||{},g=d(t?.push_server),c={status:"undeployed",deployment_secret:"abc123"};if(!0){c?.status==="undeployed"&&console.log(`
`);const y=new Date().toISOString();await m({environment:e,encrypt_build:!0,encryption_key:c?.deployment_secret,silence_confirmation:!0}),console.log("Now do the docker build.")}};var R=f;export{R as default};
