{
  "version": 3,
  "sources": ["../../../src/commands/test/index.js"],
  "sourcesContent": ["import development_server from \"../../lib/development_server/index.js\";\nimport load_settings from \"../../lib/load_settings.js\";\nimport download_database_binary from \"../../lib/development_server/databases/download_database_binary.js\";\nimport cli_log from \"../../lib/cli_log.js\";\nimport Loader from \"../../lib/loader.js\";\n\nconst install_missing_databases = async (settings = {}) => {\n  const required_databases = settings?.config?.databases?.map((database = {}) => {\n    return database?.provider;\n  });\n\n  if (required_databases?.length > 0) {\n    const loader = new Loader();\n    loader.print(\"Checking database installations...\");\n    \n    for (let i = 0; i < required_databases?.length; i += 1) {\n      const provider_name = required_databases[i];\n      try {\n        await download_database_binary(provider_name);\n      } catch (error) {\n        cli_log(`Failed to install ${provider_name} database: ${error.message}`, {\n          level: \"danger\",\n          docs: \"https://cheatcode.co/docs/joystick/databases\",\n        });\n        process.exit(1);\n      }\n    }\n  }\n};\n\nconst test = async (args = {}, options = {}) => {\n  // Load test settings to check for required databases\n  const { settings } = await load_settings('test');\n  \n  // Ensure databases are installed before starting test server\n  await install_missing_databases(settings);\n  \n  await development_server({\n    environment: 'test',\n    process,\n    port: 1977,\n    watch: options?.watch,\n  });\n};\n\nexport default test;\n"],
  "mappings": "AAAA,OAAOA,MAAwB,wCAC/B,OAAOC,MAAmB,6BAC1B,OAAOC,MAA8B,qEACrC,OAAOC,MAAa,uBACpB,OAAOC,MAAY,sBAEnB,MAAMC,EAA4B,MAAOC,EAAW,CAAC,IAAM,CACzD,MAAMC,EAAqBD,GAAU,QAAQ,WAAW,IAAI,CAACE,EAAW,CAAC,IAChEA,GAAU,QAClB,EAED,GAAID,GAAoB,OAAS,EAAG,CACnB,IAAIH,EAAO,EACnB,MAAM,oCAAoC,EAEjD,QAASK,EAAI,EAAGA,EAAIF,GAAoB,OAAQE,GAAK,EAAG,CACtD,MAAMC,EAAgBH,EAAmBE,CAAC,EAC1C,GAAI,CACF,MAAMP,EAAyBQ,CAAa,CAC9C,OAASC,EAAO,CACdR,EAAQ,qBAAqBO,CAAa,cAAcC,EAAM,OAAO,GAAI,CACvE,MAAO,SACP,KAAM,8CACR,CAAC,EACD,QAAQ,KAAK,CAAC,CAChB,CACF,CACF,CACF,EAEMC,EAAO,MAAOC,EAAO,CAAC,EAAGC,EAAU,CAAC,IAAM,CAE9C,KAAM,CAAE,SAAAR,CAAS,EAAI,MAAML,EAAc,MAAM,EAG/C,MAAMI,EAA0BC,CAAQ,EAExC,MAAMN,EAAmB,CACvB,YAAa,OACb,QACA,KAAM,KACN,MAAOc,GAAS,KAClB,CAAC,CACH,EAEA,IAAOC,EAAQH",
  "names": ["development_server", "load_settings", "download_database_binary", "cli_log", "Loader", "install_missing_databases", "settings", "required_databases", "database", "i", "provider_name", "error", "test", "args", "options", "index_default"]
}
