import o from"fs";import i from"chalk";import l from"child_process";import n from"util";import r from"../../lib/cli_log.js";import d from"../../lib/loader.js";import c from"../../lib/replace_in_files.js";const{rm:m}=o.promises,t=n.promisify(l.exec),p=async(a={},e={})=>{process.loader=new d,process.loader.print("Creating app..."),e?.release&&!["production","canary"].includes(e.release)&&(r("Must pass either production or canary for --release.",{level:"danger",docs:"https://docs.cheatcode.co/joystick/cli/create"}),process.exit(0));try{await t(`git clone https://github.com/cheatcode/joystick-default-template.git ${a.name}`),await m(`./${a.name}/.git`,{recursive:!0,force:!0}),e?.release==="canary"&&(await c(`${process.cwd()}/${a?.name}`,{match:[/\.js$/],exclude:[/node_modules/],replace_regex:/(@joystick.js\/node)(?!-)/g,replace_with:"@joystick.js/node-canary"}),await c(`${process.cwd()}/${a?.name}`,{match:[/\.js$/],exclude:[/node_modules/],replace_regex:/(@joystick.js\/ui)(?!-)/g,replace_with:"@joystick.js/ui-canary"})),setTimeout(async()=>{process.loader.print("Installing dependencies..."),await t(`cd ./${a?.name} && npm install --save @joystick.js/ui${e?.release==="canary"?"-canary":""}@latest @joystick.js/node${e?.release==="canary"?"-canary":""}@latest @joystick.js/test${e?.release==="canary"?"-canary":""}@latest`),console.log(`${i.green("Project created! To get started, run:")}
cd ${a?.name} && joystick${e?.release==="canary"?"-canary":""} start`)},1e3)}catch(s){r(`Failed to create project: ${s.message}`,{level:"danger"}),process.exit(1)}};var k=p;export{k as default};
//# sourceMappingURL=index.js.map
