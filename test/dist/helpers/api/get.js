import c from"../../lib/logRequestErrors.js";import f from"../../lib/parseJSON.js";import u from"../../lib/throwFrameworkError.js";import k from"../../lib/generateCookieHeader.js";const m=async(t={})=>{try{const e=await t.text();return f(e)}catch(e){u("api.get.handleParseResponse",e)}};var x=(t="",e={})=>{try{return typeof window.fetch<"u"&&!e?.skip?new Promise((n,s)=>{const a=e.input?JSON.stringify(e.input):null,p=e.output?JSON.stringify(e.output):null,d=`${window.location.origin}/api/_getters/${t}?input=${a}&output=${p}`,i={...e?.headers||{},"x-joystick-csrf":"joystick_test"};return e?.user&&(i.Cookie=k({joystickLoginToken:e?.user?.joystickLoginToken,joystickLoginTokenExpiresAt:e?.user?.joystickLoginTokenExpiresAt})),window.fetch(d,{method:"GET",mode:"cors",headers:i,credentials:"include",cache:"no-store"}).then(async o=>{const r=await m(o);return r?.errors?(c("get",r.errors),s(r)):n(r)}).catch(o=>(c("get",[o]),s({errors:[o]})))}):Promise.resolve()}catch(n){u("get",n)}};export{x as default};
