import f,{FormData as l}from"node-fetch";import _ from"../../lib/generate_cookie_header.js";import k from"../../lib/get_test_port.js";const m=(n="",t={})=>new Promise(async(a,c)=>{let s;if(t?.files?.length>0){s=new l;const r=Array.from(t?.files);for(let o=0;o<r?.length;o+=1){const e=r[o];s.append("files",e,e.name)}const i={"x-joystick-upload-id":"joystick_test","x-joystick-upload-input":JSON.stringify(t?.input||{})};t?.user&&(i.Cookie=_({joystick_login_token:t?.user?.joystick_login_token,joystick_login_token_expires_at:t?.user?.joystick_login_token_expires_at})),f(`http://localhost:${k()}/api/_uploaders/${n}`,{method:"POST",headers:i,body:s}).then(async o=>{const e=await o.json();e&&e.errors?c({errors:e.errors}):a(e?.uploads)})}});var p=m;export{p as default};
