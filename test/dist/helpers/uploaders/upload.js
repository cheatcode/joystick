import l,{FormData as f}from"node-fetch";import k from"../../lib/generate_cookie_header.js";const y=(n="",t={})=>new Promise(async(a,c)=>{let s;if(t?.files?.length>0){s=new f;const r=Array.from(t?.files);for(let o=0;o<r?.length;o+=1){const e=r[o];s.append("files",e,e.name)}const i={"x-joystick-upload-id":"joystick_test","x-joystick-upload-input":JSON.stringify(t?.input||{})};t?.user&&(i.Cookie=k({joystick_login_token:t?.user?.joystick_login_token,joystick_login_token_expires_at:t?.user?.joystick_login_token_expires_at})),l(`http://localhost:${process.env.PORT}/api/_uploaders/${n}`,{method:"POST",headers:i,body:s}).then(async o=>{const e=await o.json();e&&e.errors?c({errors:e.errors}):a(e?.uploads)})}});var h=y;export{h as default};
