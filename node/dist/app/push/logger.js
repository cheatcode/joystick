import t from"winston";import i from"fs";import e from"../../lib/path_exists.js";const{mkdir:a}=i.promises,n=async()=>{await e("/root/push/logs")||await a("/root/push/logs",{recursive:!0});const s="/root/push/logs/app.log";await e(s)||await writeFile(s,"");const r=t.createLogger({format:t.format.combine(t.format.timestamp(),t.format.json()),transports:[new t.transports.File({filename:s,maxsize:1024*1024*10,maxFiles:1,tailable:!0})]});process.stdout.write=o=>{r.info(o)},process.stderr.write=o=>{r.error(o)},process.on("uncaughtException",o=>{r.error(o instanceof Error?o?.toString():o)}),process.on("unhandledRejection",o=>{r.error(o instanceof Error?o?.toString():o)})};var f=n;export{f as default};
