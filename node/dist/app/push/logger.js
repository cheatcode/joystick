import t from"winston";import s from"fs";import e from"../../lib/path_exists.js";import i from"../../lib/generate_id.js";const{mkdir:a}=s.promises,n=async()=>{await e("/root/push/logs")||await a("/root/push/logs",{recursive:!0});const r=t.createLogger({format:t.format.combine(t.format.timestamp(),t.format(o=>(o._id=i(16),o))(),t.format.json()),transports:[new t.transports.File({filename:"/root/push/logs/app.log",maxsize:1024*1024*10,maxFiles:1,tailable:!0})]});process.stdout.write=o=>{r.info(o)},process.stderr.write=o=>{r.error(o)},process.on("uncaughtException",o=>{r.error(o instanceof Error?o?.toString():o)}),process.on("unhandledRejection",o=>{r.error(o instanceof Error?o?.toString():o)})};var g=n;export{g as default};
