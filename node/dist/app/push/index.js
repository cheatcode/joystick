import n from"fs";import t from"node-cron";import{NODE_CRON_EVERY_MINUTE as _,NODE_CRON_EVERY_TEN_SECONDS as a,NODE_CRON_EVERY_THIRTY_SECONDS as h}from"../../lib/constants.js";import l from"../../lib/path_exists.js";import c from"./send_instance_data_to_push.js";import i from"./snapshot_metrics.js";const{readFile:p}=n.promises,m=async()=>{const s="/root/push/logs/app.log";return await l(s)?p(s,"utf-8"):""},E=()=>{const s=t.schedule(a,async()=>{try{const o=await m();c("logs",o)}catch(o){console.warn("sync_logs_job",o)}}),e=t.schedule(h,()=>{try{const o=i();console.log({metrics:o}),c("metrics",o)}catch(o){console.warn("sync_metrics_job",o)}}),r=t.schedule(_,()=>{try{c("health-checks")}catch(o){console.warn("health_check_job",o)}});s.start(),e.start(),r.start()};var d=E;export{d as default};
