import p from"https";import{URL as c}from"url";import u from"../../app/settings/load.js";const m=async(s="",d="")=>{const h=`${u()?.private?.cheatcode?.push_debug_url||"https://push.cheatcode.co"}/api/instances/${s}`,e=new c(h);if(!await new Promise(o=>{const n=p.request({method:"HEAD",hostname:e.hostname,port:e.port||443,path:e.pathname,headers:{}},t=>{o(t.statusCode>=200&&t.statusCode<400)});n.on("error",t=>{o(!1)}),n.end()}))return;const a=JSON.stringify({type:s,data:d});return new Promise(o=>{const n=p.request({method:"POST",hostname:e.hostname,port:e.port||443,path:e.pathname,headers:{"x-push-instance-token":process.env.PUSH_INSTANCE_TOKEN,"Content-Type":"application/json","Content-Length":Buffer.byteLength(a)}},t=>{let r="";t.on("data",i=>{r+=i}),t.on("end",()=>{t.statusCode>=200&&t.statusCode<400?o(r):o()})});n.on("error",t=>{o()}),n.write(a),n.end()})};var w=m;export{w as default};
