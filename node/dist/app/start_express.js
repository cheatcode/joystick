import f from"express";import"https";import u from"./middleware/built_in.js";import _ from"../lib/get_joystick_build_path.js";import d from"../lib/types.js";const w=(r=null,o={})=>{const l=joystick?.settings?.config||{},p=_(),e=process.env.PORT?parseInt(process.env.PORT,10):2600;process.env.PORT=e;const s=f();let i="0.0.0.0";process.env.NODE_ENV!=="development"&&process.env.PUSH_DEPLOYMENT_TYPE==="standalone"&&(i="127.0.0.1");const m=s.listen(e,i);if(u({app_instance:o,csp_config:o?.options?.csp,express_app:s,joystick_build_path:p,middleware_config:l?.middleware,port:e}),o?.options?.middleware&&d.is_array(o?.options?.middleware))for(let t=0;t<o?.options?.middleware?.length;t+=1){const c=o?.options?.middleware[t];s.use(c)}const n={port:e,app:s,server:m};return d.is_function(r)&&r(n,o),n};var E=w;export{E as default};
