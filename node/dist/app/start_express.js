import c from"express";import"https";import f from"./middleware/built_in.js";import u from"../lib/get_joystick_build_path.js";import d from"../lib/types.js";const w=(i=null,o={})=>{const n=joystick?.settings?.config||{},m=u(),s=process.env.PORT?parseInt(process.env.PORT,10):2600;process.env.PORT=s;const t=c(),l=t.listen(s,"0.0.0.0");if(f({app_instance:o,csp_config:o?.options?.csp,express_app:t,joystick_build_path:m,middleware_config:n?.middleware,port:s}),o?.options?.middleware&&d.is_array(o?.options?.middleware))for(let e=0;e<o?.options?.middleware?.length;e+=1){const p=o?.options?.middleware[e];t.use(p)}const r={port:s,app:t,server:l};return d.is_function(i)&&i(r,o),r};var b=w;export{b as default};
