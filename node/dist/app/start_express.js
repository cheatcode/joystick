import l from"express";import"https";import c from"./middleware/built_in.js";import u from"../lib/get_joystick_build_path.js";import d from"../lib/types.js";const _=(s=null,o={})=>{const m=joystick?.settings?.config||{},p=u(),t=process.env.PORT?parseInt(process.env.PORT,10):2600;process.env.PORT=t;const e=l();typeof o?.options?.express?.on_after_create_app=="function"&&o.options.express.on_after_create_app(e);const n=e.listen(t,"0.0.0.0");if(c({app_instance:o,mod:o?.mod,csp_config:o?.options?.csp,express_app:e,joystick_build_path:p,middleware_config:m?.middleware,port:t}),o?.options?.middleware&&d.is_array(o?.options?.middleware))for(let r=0;r<o?.options?.middleware?.length;r+=1){const f=o?.options?.middleware[r];e.use(f)}const i={port:t,app:e,server:n};return d.is_function(s)&&s(i,o),i};var b=_;export{b as default};
