import f from"express";import u from"https";import g from"./middleware/built_in.js";import w from"../lib/get_joystick_build_path.js";import _ from"./get_ssl_certificates.js";import m from"../lib/types.js";const y=(r=null,o={})=>{const n=joystick?.settings?.config||{},c=w(),i=_(o?.options?.ssl),s=process.env.PORT?parseInt(process.env.PORT,10):2600;process.env.PORT=s;const t=f(),d=i?u.createServer(i,t).listen(s):t.listen(s);if(g({app_instance:o,csp_config:o?.options?.csp,express_app:t,joystick_build_path:c,middleware_config:n?.middleware,port:s}),o?.options?.middleware&&m.is_array(o?.options?.middleware))for(let e=0;e<o?.options?.middleware?.length;e+=1){const p=o?.options?.middleware[e];t.use(p)}const l={port:s,app:t,server:d};return m.is_function(r)&&r(l,o),l};var k=y;export{k as default};
