import f from"express";import"https";import u from"./middleware/built_in.js";import w from"../lib/get_joystick_build_path.js";import n from"../lib/types.js";const g=(r=null,o={})=>{const d=joystick?.settings?.config||{},m=w(),e=process.env.PORT?parseInt(process.env.PORT,10):2600;process.env.PORT=e;const s=f(),p=process.env.NODE_ENV!=="development"?"127.0.0.1":"0.0.0.0",c=s.listen(e,p);if(u({app_instance:o,csp_config:o?.options?.csp,express_app:s,joystick_build_path:m,middleware_config:d?.middleware,port:e}),o?.options?.middleware&&n.is_array(o?.options?.middleware))for(let t=0;t<o?.options?.middleware?.length;t+=1){const l=o?.options?.middleware[t];s.use(l)}const i={port:e,app:s,server:c};return n.is_function(r)&&r(i,o),i};var O=g;export{O as default};
