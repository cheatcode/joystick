import n from"../../lib/types.js";const o=(a,l,i,s=null)=>{if(s&&n.is_object(s)){const e={"base-uri":["'self'"],"child-src":["'self'"],"connect-src":["'self'","wss:"],"default-src":["'self'"],"font-src":["'self'"],"form-action":["'self'"],"frame-src":["'self'"],"img-src":["'self'"],"manifest-src":["'self'"],"media-src":["'self'"],"object-src":["'self'"],"script-src":["'self'"],"script-src-attr":["'self'"],"script-src-elem":["'self'"],"style-src":["'self'"],"style-src-attr":["'self'"],"style-src-elem":["'self'"],"worker-src":["'self'"]};process.env.NODE_ENV==="development"&&(e["script-src"].push("'unsafe-eval'"),e["connect-src"].push("ws:"));const c=Object.keys(e||{});for(let r=0;r<c?.length;r+=1){const t=c[r];e[t]=[...e[t]||[],...s?.unrestrictedOrigins||s?.unrestricted_origins||[],...s?.directives&&s?.directives[t]||[]]}const f=Object.keys(e||{}).map(r=>`${r} ${e[r].join(" ")}`)?.join("; ");l.setHeader("Content-Security-Policy",f)}i()};var m=o;export{m as default};
