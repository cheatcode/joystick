import o from"../databases/queries/accounts.js";import r from"../settings/load.js";import n from"../email/send.js";const a=(e="",i="")=>{const t=r();return n({to:e,from:t?.config?.email?.from,subject:t?.config?.email?.verify?.subject||"Verify your email address",template:t?.config?.email?.verify?.template||"verify_email",props:{emailAddress:e,email_address:e,url:process.env.NODE_ENV==="development"?`http://localhost:${process.env.PORT}/api/_accounts/verify-email?token=${i}`:`${process.env.ROOT_URL}/api/_accounts/verify-email?token=${i}`}})},s=(e="")=>o("create_email_verification_token",{user_id:e}),c=(e="")=>o("user",{_id:e}),m=async(e="")=>{console.log("SEND VERIFICATION",e);const i=await c(e);if(!i?.emailVerified&&!i?.emailVerifiedAt){const t=await s(i?._id||i?.user_id);await a(i?.emailAddress,t)}return!0};var u=m;export{u as default};
