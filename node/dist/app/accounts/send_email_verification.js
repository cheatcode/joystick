import r from"../databases/queries/accounts.js";import o from"../settings/load.js";import a from"../email/send.js";const n=(e="",i="")=>{const t=o();return a({to:e,from:t?.config?.email?.from,subject:t?.config?.email?.verify?.subject||"Verify your email address",template:t?.config?.email?.verify?.template||"verify_email",props:{emailAddress:e,email_address:e,url:process.env.NODE_ENV==="development"?`http://localhost:${process.env.PORT}/api/_accounts/verify_email?token=${i}`:`${process.env.ROOT_URL}/api/_accounts/verify_email?token=${i}`}})},s=(e="")=>r("create_email_verification_token",{user_id:e}),c=(e="")=>r("user",{_id:e}),m=async(e="")=>{const i=await c(e);if(!i?.emailVerified&&!i?.emailVerifiedAt){const t=await s(i?._id||i?.user_id);await n(i?.emailAddress,t)}return!0};var u=m;export{u as default};
