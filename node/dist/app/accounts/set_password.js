import e from"../databases/queries/accounts.js";import n from"../../lib/hash_string.js";import t from"../../lib/types.js";const i=(s=null)=>e("reset_user_sessions",{user_id:s}),a=async(s="",r="")=>{const o=n(r);return await e("set_new_password",{user_id:s,hashed_password:o}),o},u=(s="")=>e("user",{_id:s}),c=async(s={})=>{if(!s?.user_id||!s?.password)throw new Error("Must provider a user_id and password to set.");const r=await u(s?.user_id);if(!r)throw new Error("Invalid user_id.");return await a(r?._id||r?.user_id,s?.password),await i(r?._id||r?.user_id),(t.is_function(process.joystick?.app_options?.accounts?.events?.onSetPassword)||t.is_function(process.joystick?.app_options?.accounts?.events?.on_set_password))&&(process.joystick?.app_options?.accounts?.events?.onSetPassword||process.joystick?.app_options?.accounts?.events?.on_set_password)(s?.user_id),!0};var w=c;export{w as default};
