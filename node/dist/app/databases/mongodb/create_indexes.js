import t from"../../../lib/types.js";const s={sessions:async()=>{try{console.log("Starting index creation for sessions collection"),await process.databases._sessions?.collection("sessions").createIndex({createdAt:1},{expireAfterSeconds:3600,background:!0}),console.log("Successfully created index for sessions collection")}catch(r){console.error("Error creating index for sessions collection:",r)}},users:async()=>{const r=[{key:{emailAddress:1},options:{background:!0,unique:!0}},{key:{username:1},options:{background:!0,unique:!0}},{key:{"sessions.token":1},options:{background:!0}},{key:{"passwordResetTokens.token":1},options:{background:!0}},{key:{"passwordResetTokens.token":1,_id:1},options:{background:!0}},{key:{roles:1},options:{background:!0}},{key:{roles:1,_id:1},options:{background:!0}}];for(const{key:e,options:o}of r)try{console.log(`Starting index creation for users collection: ${JSON.stringify(e)}`),await process.databases._users?.collection("users").createIndex(e,o),console.log(`Successfully created index for users collection: ${JSON.stringify(e)}`)}catch(n){console.error(`Error creating index for users collection ${JSON.stringify(e)}:`,n)}try{console.log("Starting index creation for roles collection (role: 1)"),await process.databases._users?.collection("roles").createIndex({role:1},{background:!0}),console.log("Successfully created index for roles collection (role: 1)")}catch(e){console.error("Error creating index for roles collection (role: 1):",e)}try{console.log("Starting index creation for roles collection (role: 1, userId: 1)"),await process.databases._users?.collection("roles").createIndex({role:1,userId:1},{background:!0}),console.log("Successfully created index for roles collection (role: 1, userId: 1)")}catch(e){console.error("Error creating index for roles collection (role: 1, userId: 1):",e)}}},c=async(r=[])=>{for(let e=0;e<r?.length;e+=1){const o=r[e];t.is_function(s[o])?(console.log(`Starting index creation for database type: ${o}`),await s[o](),console.log(`Completed index creation for database type: ${o}`)):console.warn(`No index creation function found for database type: ${o}`)}};var l=c;export{l as default};
