import g from"node-html-parser";import u from"../../lib/types.js";import o from"../../lib/escape_html.js";const m=(y="",t=null,b={})=>{const p=g.parse(y),a=p.querySelector("head");if(!t)return p.toString();if(t.title){const e=a.querySelector("title"),s=o(t.title);if(e){const i=g.parse(`<title>${s}</title>`);a.exchangeChild(e,i)}e||a.insertAdjacentHTML("afterbegin",`<title>${s}</title>`)}if(t.tags&&t.tags.meta&&u.is_array(t.tags.meta)&&t.tags.meta.length>0)for(let e=0;e<t?.tags?.meta?.length;e+=1){const s=t.tags.meta[e],i=a.querySelector(`meta[name="${s.name}"]`),n=g.parse("<meta />"),r=Object.entries(s||{});for(let l=0;l<r?.length;l+=1){const[c,_]=r[l];n.querySelector("meta").setAttribute(c,o(_))}i&&a.exchangeChild(i,n),i||a.appendChild(n)}if(t.tags&&t.tags.link&&u.is_array(t.tags.link)&&t.tags.link.length>0)for(let e=0;e<t?.tags?.link?.length;e+=1){const s=t?.tags?.link[e],i=g.parse("<link />"),n=Object.entries(s||{});for(let r=0;r<n?.length;r+=1){const[l,c]=n[r];i.querySelector("link").setAttribute(l,o(c))}a.appendChild(i)}if(t.tags&&t.tags.script&&Array.isArray(t.tags.script)&&t.tags.script.length>0)for(let e=0;e<t?.tags?.script?.length;e+=1){const s=t.tags.script[e],i=g.parse("<script></script>"),n=Object.entries(s||{});for(let r=0;r<n?.length;r+=1){const[l,c]=n[r];i.querySelector("script").setAttribute(l,o(c))}a.appendChild(i)}if(t.tags&&t.tags.style&&Array.isArray(t.tags.style)&&t.tags.style.length>0)for(let e=0;e<t?.tags?.style?.length;e+=1){const{attributes:s={},content:i=""}=t.tags.style[e],n=g.parse("<style></style>"),r=Object.entries(s),l=n.querySelector("style");l.setAttribute("type","text/css");for(let c=0;c<r?.length;c+=1){const[_,f]=r[c];l.setAttribute(_,o(f))}i&&(l.innerHTML=o(i)),a.appendChild(n)}if(t.jsonld){const e=g.parse("<script></script>"),s=e.querySelector("script");s.setAttribute("type","application/ld+json"),s.set_content(JSON.stringify(t.jsonld,null,2)),a.appendChild(e)}return p.toString()};var q=m;export{q as default};
