import d from"../lib/debounced_queue.js";const t=(s="")=>({add:(o={})=>{if(!process.caches[s]){console.warn(`Could not find process.caches.${s}. Did you call cache('${s}').open()?`);return}process.caches._queues[s].add(()=>{process.caches[s]=[...process.caches[s]||[],o]})},find:(o=null)=>o?process.caches[s]?.filter(r=>r[o[0]]===o[1]):process.caches[s],find_one:(o=null)=>o?process.caches[s]?.find(r=>r[o[0]]===o[1]):null,open:()=>{process.caches[s]=[],process.caches._queues={...process.caches.queues||{},[s]:new d}},set:(o=[])=>{if(!process.caches[s]){console.warn(`Could not find process.caches.${s}. Did you call cache('${s}').open()?`);return}process.caches._queues[s].add(()=>{process.caches[s]=o})},update:([o="",r=""],u={})=>{if(!process.caches[s]){console.warn(`Could not find process.caches.${s}. Did you call cache('${s}').open()?`);return}process.caches._queues[s].add(()=>new Promise(p=>{let e=process.caches[s]?.find(c=>c[o]=r);e&&(process.caches[s]=(process.caches[s]||[])?.filter((c={})=>c[o]?c[o]!==r:!0),e={...e||{},...u||{}},process.caches[s]=[...process.caches[s]||[],e]),setTimeout(()=>{p()},100)}))}});var l=t;export{l as default};
